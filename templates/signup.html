<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign Up - Faculty Management Desk</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f4f4;
    }
    .form-container {
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      max-width: 500px;
      margin: 30px auto;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
    .form-container h2 {
      text-align: center;
      margin-bottom: 25px;
    }
    .form-control, .form-select {
      margin-bottom: 15px;
    }
    .btn-submit {
      width: 100%;
      padding: 10px;
      font-size: 1.2rem;
    }
    .banner {
      display: block;
      max-width: 100%;
      height: auto;
      margin: 20px auto;
      border-radius: 10px;
    }
    .pass-field {
      position: relative;
    }
    .pass-field i {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      cursor: pointer;
      color: #6c757d;
    }
    .requirement-list,
    .email-requirements {
      margin-top: 10px;
      padding-left: 20px;
    }
    .requirement-list li,
    .email-requirements li {
      font-size: 0.9rem;
      margin-bottom: 5px;
      color: #6c757d;
      list-style: none;
      display: flex;
      align-items: center;
    }
    .requirement-list li i,
    .email-requirements li i {
      margin-right: 8px;
      font-size: 0.7rem;
    }
    .requirement-list li.valid i,
    .email-requirements li.valid i {
      color: green;
      font-size: 0.9rem;
    }
    .requirement-list li.valid span,
    .email-requirements li.valid span {
      color: green;
    }
    .btn-submit:disabled {
      opacity: 0.65;
      cursor: not-allowed;
    }
    .error-message {
      color: red;
      font-size: 0.9rem;
      margin-top: -10px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Banner Image -->
    <img src="{{ url_for('static', filename='logo.jpg') }}" alt="College Banner" class="banner">

    <div class="form-container">
      <h2 class="fw-bold">Sign Up for Faculty Management Desk</h2>
      <form method="POST" action="{{ url_for('signup') }}" enctype="multipart/form-data">

        <!-- Name -->
        <div class="mb-3">
          <label for="name" class="form-label">Full Name</label>
          <input type="text" class="form-control" id="name" name="name" required>
        </div>

        <!-- Email -->
        <div class="mb-3">
          <label for="email" class="form-label">Email Address</label>
          <input type="email" class="form-control" id="email" name="email" required>
          <div id="emailError" class="error-message d-none">Please enter a valid email address.</div>
        </div>

        <!-- Contact Info -->
        <div class="mb-3">
          <label for="contact" class="form-label">Contact Number</label>
          <input type="text" class="form-control" id="contact" name="contact"
                 pattern="\d{10}" maxlength="10"
                 title="Enter a 10-digit contact number" required>
        </div>

        <!-- Department -->
        <div class="mb-3">
          <label for="department" class="form-label">Department</label>
          <input type="text" class="form-control" name="department" placeholder="Department Name" required>
        </div>

        <!-- Role Selection -->
        <div class="mb-3">
          <label for="role" class="form-label">Role</label>
          <select class="form-select" id="role" name="role" required>
            <option value="">-- Select Role --</option>
            <option value="faculty">Faculty</option>
            <option value="hod">HOD</option>
          </select>
        </div>

        <!-- Optional Checkbox -->
        <div class="mb-3">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="is_faculty_checkbox" value="yes" id="facultyCheck">
            <label class="form-check-label" for="facultyCheck">
              I am also a Faculty (use same credentials for both roles)
            </label>
          </div>
        </div>

        <!-- âœ… Profile Image Upload -->
        <div class="mb-3">
          <label for="profile_img" class="form-label">Upload Profile Image</label>
          <input type="file" class="form-control" id="profile_img" name="profile_img" accept="image/*">
        </div>

        <!-- Password with validation -->
        <div class="mb-3">
          <label for="password" class="form-label">Password</label>
          <div class="pass-field">
            <input type="password" class="form-control" id="password" name="password" required>
            <i class="fa-solid fa-eye" id="togglePassword"></i>
          </div>
          <ul class="requirement-list mt-2">
            <li><i class="fa-solid fa-circle"></i><span>At least 8 characters</span></li>
            <li><i class="fa-solid fa-circle"></i><span>At least 1 number (0-9)</span></li>
            <li><i class="fa-solid fa-circle"></i><span>At least 1 lowercase letter (a-z)</span></li>
            <li><i class="fa-solid fa-circle"></i><span>At least 1 special character (!@#$...)</span></li>
            <li><i class="fa-solid fa-circle"></i><span>At least 1 uppercase letter (A-Z)</span></li>
          </ul>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary btn-submit" id="submitBtn" disabled>Sign Up</button>
      </form>
    </div>
  </div>

  <script>
    const passInput = document.getElementById("password");
    const eyeIcon = document.getElementById("togglePassword");
    const reqList = document.querySelectorAll(".requirement-list li");
    const emailInput = document.getElementById("email");
    const emailError = document.getElementById("emailError");
    const contactInput = document.getElementById("contact");
    const submitBtn = document.getElementById("submitBtn");
    const roleSelect = document.getElementById("role");
    const facultyCheckbox = document.getElementById("facultyCheck");

    const passRequirements = [
      { regex: /.{8,}/, index: 0 },
      { regex: /[0-9]/, index: 1 },
      { regex: /[a-z]/, index: 2 },
      { regex: /[^A-Za-z0-9]/, index: 3 },
      { regex: /[A-Z]/, index: 4 }
    ];

    function validateAll() {
      const passValid = passRequirements.every(item => item.regex.test(passInput.value));
      const emailValid = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(emailInput.value);
      const contactValid = /^\d{10}$/.test(contactInput.value);

      emailError.classList.toggle("d-none", emailValid);
      submitBtn.disabled = !(passValid && emailValid && contactValid);
    }

    passInput.addEventListener("keyup", (e) => {
      passRequirements.forEach((item) => {
        const isValid = item.regex.test(e.target.value);
        const requirementItem = reqList[item.index];
        if (isValid) {
          requirementItem.classList.add("valid");
          requirementItem.querySelector("i").className = "fa-solid fa-check";
        } else {
          requirementItem.classList.remove("valid");
          requirementItem.querySelector("i").className = "fa-solid fa-circle";
        }
      });
      validateAll();
    });

    emailInput.addEventListener("input", () => {
      validateAll();
    });

    contactInput.addEventListener("input", function () {
      this.value = this.value.replace(/\D/g, '').slice(0, 10);
      validateAll();
    });

    eyeIcon.addEventListener("click", () => {
      const type = passInput.getAttribute("type") === "password" ? "text" : "password";
      passInput.setAttribute("type", type);
      eyeIcon.classList.toggle("fa-eye-slash");
    });

    roleSelect.addEventListener("change", () => {
      facultyCheckbox.disabled = roleSelect.value === "faculty";
    });

    // Initial validation and checkbox setup
    validateAll();
    if (roleSelect.value === "faculty") {
      facultyCheckbox.disabled = true;
    }
  </script>
</body>
</html>
